(this.webpackJsonpmapboxAndReact=this.webpackJsonpmapboxAndReact||[]).push([[0],{60:function(_,e,t){_.exports=t(61)},61:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _home_ubuntu_environment_imagery_tcd_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(34),_home_ubuntu_environment_imagery_tcd_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(54),_home_ubuntu_environment_imagery_tcd_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(55),_home_ubuntu_environment_imagery_tcd_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(59),_home_ubuntu_environment_imagery_tcd_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createSuper__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(58),react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(4),react__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_5__),react_dom__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(56),react_dom__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(react_dom__WEBPACK_IMPORTED_MODULE_6__),mapbox_gl__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(31),mapbox_gl__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(mapbox_gl__WEBPACK_IMPORTED_MODULE_7__),_mapbox_mapbox_gl_draw__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(33),_mapbox_mapbox_gl_draw_dist_mapbox_gl_draw_css__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(92),_mapbox_mapbox_gl_draw_dist_mapbox_gl_draw_css__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(_mapbox_mapbox_gl_draw_dist_mapbox_gl_draw_css__WEBPACK_IMPORTED_MODULE_9__),mapbox_gl_draw_circle__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(8),_turf_turf__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(32),_turf_turf__WEBPACK_IMPORTED_MODULE_11___default=__webpack_require__.n(_turf_turf__WEBPACK_IMPORTED_MODULE_11__);mapbox_gl__WEBPACK_IMPORTED_MODULE_7___default.a.accessToken="pk.eyJ1IjoiYmxpc2h0ZW4iLCJhIjoiMEZrNzFqRSJ9.0QBRA2HxTb8YHErUFRMPZg";var PYTHON_REST_SERVER_ENDPOINT="https://andrewcottam.com:8081/python-rest-server/restor/services/",GEE_IMAGE_SERVER_ENDPOINT="https://geeimageserver.appspot.com/",draw,map,Application=function(_React$Component){Object(_home_ubuntu_environment_imagery_tcd_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_3__.a)(Application,_React$Component);var _super=Object(_home_ubuntu_environment_imagery_tcd_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createSuper__WEBPACK_IMPORTED_MODULE_4__.a)(Application);function Application(_){var e;return Object(_home_ubuntu_environment_imagery_tcd_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_1__.a)(this,Application),(e=_super.call(this,_)).state={lng:-69.44916228299296,lat:-12.833871131544694,zoom:17},e}return Object(_home_ubuntu_environment_imagery_tcd_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_2__.a)(Application,[{key:"componentDidMount",value:function(){var _=this;(map=new mapbox_gl__WEBPACK_IMPORTED_MODULE_7___default.a.Map({container:this.mapContainer,style:"mapbox://styles/mapbox/streets-v11",center:[this.state.lng,this.state.lat],zoom:this.state.zoom})).on("move",(function(){_.setState({lng:map.getCenter().lng.toFixed(4),lat:map.getCenter().lat.toFixed(4),zoom:map.getZoom().toFixed(2)})})),map.on("load",(function(){var e=_turf_turf__WEBPACK_IMPORTED_MODULE_11__.point([0,40]),t=_turf_turf__WEBPACK_IMPORTED_MODULE_11__.circle(e,25,{steps:80,units:"kilometers"});map.addSource("circleData",{type:"geojson",data:t}),map.addLayer({id:"circle-fill",type:"fill",source:"circleData",paint:{"fill-color":"red","fill-opacity":1}}),draw=new _mapbox_mapbox_gl_draw__WEBPACK_IMPORTED_MODULE_8__.a({defaultMode:"draw_circle",displayControlsDefault:!1,userProperties:!0,modes:Object(_home_ubuntu_environment_imagery_tcd_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__.a)(Object(_home_ubuntu_environment_imagery_tcd_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__.a)({},_mapbox_mapbox_gl_draw__WEBPACK_IMPORTED_MODULE_8__.a.modes),{},{draw_circle:mapbox_gl_draw_circle__WEBPACK_IMPORTED_MODULE_10__.a,drag_circle:mapbox_gl_draw_circle__WEBPACK_IMPORTED_MODULE_10__.c,direct_select:mapbox_gl_draw_circle__WEBPACK_IMPORTED_MODULE_10__.b,simple_select:mapbox_gl_draw_circle__WEBPACK_IMPORTED_MODULE_10__.d})}),map.addControl(draw),draw.changeMode("drag_circle"),map.on("draw.selectionchange",(function(_){draw.changeMode("drag_circle")})),_.nextImage()}))}},{key:"_get",value:function(_){return new Promise((function(e,t){fetch(_).then((function(_){_.json().then((function(_){e(_)}))}))}))}},{key:"postFeatures",value:function(){var _=this,e=draw&&draw.getAll().features;e&&e.length>0&&e.forEach((function(e){if(e.properties.center.length>0){var t=e.properties.center;_._get(PYTHON_REST_SERVER_ENDPOINT+"set_tcd_feature?_id="+e.id+"&_longitude="+t[0]+"&_latitude="+t[1]+"&_radius="+1e3*e.properties.radiusInKm+"&_gee_imageid=gee1234&_entered_by=andrew")}}))}},{key:"nextImage",value:function nextImage(){var _this4=this;this.postFeatures();var collectionid="GOOGLE/GEO/ALL/SATELLITE/WORLDVIEW3/ORTHO/RGB";this._get(GEE_IMAGE_SERVER_ENDPOINT+"getIdsForPoint?lng="+this.state.lng+"&lat="+this.state.lat+"&collectionid="+collectionid).then((function(json){var sceneIds=eval(json.records.substring(json.records.indexOf("["),json.records.length-1)),sceneId=sceneIds.length?sceneIds[0]:void 0;sceneId&&_this4.addGEEImage(sceneId)}))}},{key:"addGEEImage",value:function(_){map.addSource("gee-source",{type:"raster",tiles:["https://geeimageserver.appspot.com/ogc?service=WMS&request=GetMap&version=1.1.1&styles=&format=image%2Fpng&transparent=false&layers=["+_+"]&srs=EPSG%3A3857&bbox={bbox-epsg-3857}"],tileSize:256}),map.addLayer({id:"gee-layer",type:"raster",source:"gee-source",paint:{}},"gl-draw-polygon-fill-inactive.cold")}},{key:"render",value:function(){var _=this;return react__WEBPACK_IMPORTED_MODULE_5___default.a.createElement("div",null,react__WEBPACK_IMPORTED_MODULE_5___default.a.createElement("div",{className:"sidebarStyle"},react__WEBPACK_IMPORTED_MODULE_5___default.a.createElement("div",null,"Longitude: ",this.state.lng," | Latitude: ",this.state.lat," | Zoom: ",this.state.zoom)),react__WEBPACK_IMPORTED_MODULE_5___default.a.createElement("div",{ref:function(e){return _.mapContainer=e},className:"mapContainer"}),react__WEBPACK_IMPORTED_MODULE_5___default.a.createElement("div",{onClick:this.nextImage.bind(this),className:"next"},"Next"))}}]),Application}(react__WEBPACK_IMPORTED_MODULE_5___default.a.Component);react_dom__WEBPACK_IMPORTED_MODULE_6___default.a.render(react__WEBPACK_IMPORTED_MODULE_5___default.a.createElement(Application,null),document.getElementById("app"))}},[[60,1,2]]]);
//# sourceMappingURL=main.8881f24a.chunk.js.map